/*! nbhMapKnockout - version 1.0.0 */
!function(){var a={currentCity:null,cities:["Bilbao"],foursquareData:[],filteredPlaces:[],filteredNames:[],pinPosterLocations:[],markers:[],infoWindows:[]},b={setFoursquareData:function(b){a.foursquareData=b},getFoursquareData:function(){return a.foursquareData},setFilteredPlaces:function(b){a.filteredPlaces=b},getFilteredPlaces:function(){return a.filteredPlaces},setFilteredNames:function(b){a.filteredNames=b},getFilteredNames:function(){return a.filteredNames},setMarkers:function(b){a.markers.push(b)},getMarkers:function(){return a.markers},setInfoWindows:function(b){a.infoWindows.push(b)},getInfoWindows:function(){return a.infoWindows},setPinPosterLocations:function(b){a.pinPosterLocations.push(b)},getPinPosterLocations:function(){return a.pinPosterLocations},clearMarkers:function(){a.markers=[]},clearInfoWindows:function(){a.infoWindows=[]}},c=function(a){function c(a){function c(a){var b='<div id="content"><h3 id="firstHeading" class="firstHeading">'+a.formatted_address+"</h3></div>";return b}console.log(a);var d=a.geometry.location.lat(),f=a.geometry.location.lng(),g=(a.name,a.formatted_address),h=(c(a),window.mapBounds),i=new google.maps.Marker({map:e,position:a.geometry.location,title:g});b.setMarkers(i);var j=new google.maps.InfoWindow({content:g});b.setInfoWindows(j),google.maps.event.addListener(i,"click",function(){j.open(e,i)}),h.extend(new google.maps.LatLng(d,f)),e.fitBounds(h),e.setCenter(h.getCenter())}function d(a,b){var d=$("#google-map-error-panel");return b!=google.maps.places.PlacesServiceStatus.OK?void d.html("<h2>Sorry, Google Maps could not be loaded</h2>"):void(b==google.maps.places.PlacesServiceStatus.OK&&c(a[0]))}function f(a){if("undefined"==typeof google.maps.places)return $("#google-map-error-panel").html("<h2>Sorry, Google Maps could not be loaded</h2>"),void console.log("undefined!");var b=new google.maps.places.PlacesService(e);for(place in a){var c={query:a[place]};b.textSearch(c,d)}}function g(a){var b=0,c=m.length;for(console.log(c),b;c>b;b++)m[b].setMap(a)}function h(){q.style.display="block",q.style.webkitAnimationName="fadeIn",q.style.webkitAnimationDuration="1s",r.value=" ",m.splice(7),n.splice(7),g(e)}function i(){g(null)}var j=this;j.name=ko.observable(a.name),j.address=ko.observable(a.address),j.city=ko.observable(a.city),j.country=ko.observable(a.country),j.location=ko.observable(a.location),j.rating=ko.observable(a.rating),j.listView=ko.pureComputed(function(){return j.name()+"    "+j.rating()}),console.log(j.address()),b.setPinPosterLocations(j.location());var k=b.getPinPosterLocations(),l=[];l.push(j.location()),console.log(l);var m=b.getMarkers();console.log(m);var n=b.getInfoWindows();console.log(n);var o=document.getElementById("show"),p=document.getElementById("hide"),q=document.getElementById("places-list"),r=(document.getElementById("foursquare-header"),document.getElementById("autocomplete"));o.style.display="none",this.setCurrentPlace=function(a){if(m.length<7){var b=0,c=0,d=0,f=0,g=(m.length,n.length);for(console.log(m),console.log(n),b;g>b;c++,b++){var h=m[b],i=n[c];if(a.address()==i.content&&a.address()===h.title)if(null!=h.getAnimation())for(f;g>f;d++,f++){var j=m[d],k=n[f];j.setAnimation(null),k.close(e,h)}else for(f;g>f;d++,f++){var l=m[d],o=n[f];l.setAnimation(null),o.close(e,h),h.setAnimation(google.maps.Animation.BOUNCE),i.open(e,h)}}}else{var b=0,c=0,d=0,f=0;m.splice(7),n.splice(7);var p=(m.length,n.length);for(b;p>b;c++,b++){var q=m[b],r=n[c];if(a.address()==r.content&&a.address()===q.title)if(null!=q.getAnimation())for(f;p>f;d++,f++){var s=m[d],t=n[f];s.setAnimation(null),t.close(e,q)}else for(f;p>f;d++,f++){var u=m[d],v=n[f];u.setAnimation(null),v.close(e,q),q.setAnimation(google.maps.Animation.BOUNCE),r.open(e,q)}}}},$(r).devbridgeAutocomplete({lookup:k,minChars:1,onSearchComplete:function(a,b){q.style.display="none",q.style.webkitAnimationName="fadeOut",q.style.webkitAnimationDuration="1s",o.style.display="none",o.style.webkitAnimationName="fadeOut",o.style.webkitAnimationDuration="1s";var c=[];for(suggestion in b){var d=b[suggestion].value;c.push(d)}i(),f(c)},onSelect:function(a){var b=[],c=a.value;b.push(c),console.log(b),i(),f(b),"none"==p.style.display&&"none"==o.style.display&&(p.style.display="inline",p.style.webkitAnimationName="fadeIn",p.style.webkitAnimationDuration="0.8s")},showNoSuggestionNotice:!0,noSuggestionNotice:"Sorry, no matching results"}),o.addEventListener("click",function(){h(),o.style.display="none",o.style.webkitAnimationName="fadeOut",o.style.webkitAnimationDuration="1s",p.style.display="inline",p.style.webkitAnimationName="fadeIn",p.style.webkitAnimationDuration="0.8s"},!1),p.addEventListener("click",function(){i(),o.style.display="inline",o.style.webkitAnimationName="fadeIn",o.style.webkitAnimationDuration="0.8s",p.style.display="none",p.style.webkitAnimationName="fadeOut",p.style.webkitAnimationDuration="1s"},!1),window.mapBounds=new google.maps.LatLngBounds,f(l),window.addEventListener("resize",function(a){e.fitBounds(mapBounds)})},d={disableDefaultUI:!1};if("undefined"==typeof google)return $("#google-map-error-panel").html("<h2>Sorry, Google Maps could not be loaded</h2>"),void console.log("undefined!");var e=new google.maps.Map(document.getElementById("mapDiv"),d),f=function(){function d(a){return $.getJSON(i,function(b){var c=[];c=b.response.groups[0].items,a(c)}).error(function(a){f.html("<h2>Sorry, Foursquare articles could not be loaded</h2>")}),!1}var e=this;this.currentCity=ko.observableArray([]),this.currentCity=a.cities[0],console.log(e.currentCity);var f=($("#places-list"),$("#foursquare-error-panel"));this.places=ko.observableArray([]);var g="WMGXUPU15HUVPMTMGK3WZPHVGBXKPXWMUQ5WW3DMRSOZUIH5",h="RFUOHDP441JSHFBS1AS0KLAGRVVRGNL2VACN0RHIJJNC5AT2",i="https://api.foursquare.com/v2/venues/explore?near="+e.currentCity+"&&client_id="+g+"&client_secret="+h+"&v=20130815&query=sushi";d(function(a){var d=a;console.log(d);var f=0,g=0,h=0,i=0,j=d.length,k=[],l=[];for(f;j>f;f++){var m=d[f],n=m.venue.name;"Miu Japonés"!=n&&"Miu"!=n&&"Shibui Bilbo"!=n&&"Wok Chitau Nauo"!=n&&"Restaurante Xikelai Wok"!=n&&"SUMO Ledesma"!=n&&"SUMO"!=n&&k.push(m)}for(g;g<k.length;g++){var o=k[g],p=o.venue.name,q=o.venue.location.address,r=o.venue.location.city,s=o.venue.location.country,t=o.venue.rating,u={name:p,address:q,city:r,country:s,location:p+", "+q+", "+r+", "+s,rating:t};l.push(u)}for(h;h<l.length;h++){var v,w=l[h],x=w.name;"Kuma"===x?(v=x.replace("Kuma","KUMA"),w.name=v):"Mao Restaurante"===x?(v=x.replace("Mao Restaurante","Mao"),w.name=v):"SUMO Poza"===x?(v=x.replace("SUMO Poza","SUMO Pozas"),w.name=v):"Sakura"===x?(v=x.replace("Sakura","Restaurante Sakura"),w.name=v):"Wasabi Bilbao Restaurante Japones"===x&&(v=x.replace("Wasabi Bilbao Restaurante Japones","Restaurante Wasabi Bilbao"),w.name=v)}for(i;i<l.length;i++){var y,w=l[i],z=w.address;"Lersundi Kalea, 3"===z?(console.log(" Wasabi Eureka!"),y=z.replace("Lersundi Kalea, 3","Lersundi Kalea, 3, 48009 Bilbao, Bizkaia, Spain"),w.address=y):"Arbolantxa 2"===z?(console.log(" Sakura Eureka!"),y=z.replace("Arbolantxa 2","Arbolantxa Kalea, 2, 48001 Bilbao, Bizkaia, Spain"),w.address=y):"Ercilla 8"===z?(console.log(" Kuma Eureka!"),y=z.replace("Ercilla 8","Ercilla Kalea, 8, 48009 Bilbao, Bizkaia, Spain"),w.address=y):"C/ Licenciado Poza, 39"===z?(console.log(" SUMO Pozas Eureka!"),y=z.replace("C/ Licenciado Poza, 39","Poza Lizentziatuaren Kalea, 39, 48011 Bilbao, Bizkaia, Spain"),w.address=y):"Ledesma, 30"===z?(console.log(" Asia Chic Eureka!"),y=z.replace("Ledesma, 30","Ledesma Musikariaren Kalea, 30, 48001 Bilbao, Bizkaia, Spain"),w.address=y):"Ibáñez de Bilbao, 11"===z?(console.log(" Mao Eureka!"),y=z.replace("Ibáñez de Bilbao, 11","Ibáñez de Bilbao Kalea, 11, 48009 Bilbao, Bizkaia, Spain"),w.address=y):"Licenciado Poza 48"===z&&(console.log(" Sushi Artist Eureka!"),y=z.replace("Licenciado Poza 48","Licenciado Poza 48, 48013 Bilbao, Biscay, Spain"),w.address=y)}l.forEach(function(a){e.places.push(new c(a))}),b.setFoursquareData(d),b.setFilteredPlaces(k),b.setFilteredNames(l)})};ko.applyBindings(new f)}(),function(){var a={currentCity:null,cities:["Bilbao"],foursquareData:[],filteredPlaces:[],filteredNames:[],pinPosterLocations:[],markers:[],infoWindows:[]},b={setFoursquareData:function(b){a.foursquareData=b},getFoursquareData:function(){return a.foursquareData},setFilteredPlaces:function(b){a.filteredPlaces=b},getFilteredPlaces:function(){return a.filteredPlaces},setFilteredNames:function(b){a.filteredNames=b},getFilteredNames:function(){return a.filteredNames},setMarkers:function(b){a.markers.push(b)},getMarkers:function(){return a.markers},setInfoWindows:function(b){a.infoWindows.push(b)},getInfoWindows:function(){return a.infoWindows},setPinPosterLocations:function(b){a.pinPosterLocations.push(b)},getPinPosterLocations:function(){return a.pinPosterLocations},clearMarkers:function(){a.markers=[]},clearInfoWindows:function(){a.infoWindows=[]}},c=function(a){function c(a){var c=a.geometry.location.lat(),d=a.geometry.location.lng(),f=a.name,g=(a.formatted_address,window.mapBounds),h=new google.maps.Marker({map:e,position:a.geometry.location,title:f});b.setMarkers(h);var i=new google.maps.InfoWindow({content:f});b.setInfoWindows(i),google.maps.event.addListener(h,"click",function(){i.open(e,h)}),g.extend(new google.maps.LatLng(c,d)),e.fitBounds(g),e.setCenter(g.getCenter())}function d(a,b){b==google.maps.places.PlacesServiceStatus.OK&&c(a[0])}function f(a){var b=new google.maps.places.PlacesService(e);for(place in a){var c={query:a[place]};b.textSearch(c,d)}}function g(a){var b=0,c=m.length;for(console.log(c),b;c>b;b++)m[b].setMap(a)}function h(){q.style.display="block",q.style.webkitAnimationName="fadeIn",q.style.webkitAnimationDuration="1s",o.style.display="none",o.style.webkitAnimationName="fadeOut",o.style.webkitAnimationDuration="1s",r.innerHTML="Foursquare recommended places(choose!):",s.value=" ",m.splice(7),n.splice(7),g(e)}function i(){g(null),"none"==o.style.display&&(o.style.display="inline",o.style.webkitAnimationName="fadeIn",o.style.webkitAnimationDuration="0.8s")}var j=this;j.name=ko.observable(a.name),j.address=ko.observable(a.address),j.city=ko.observable(a.city),j.country=ko.observable(a.country),j.location=ko.observable(a.location),j.rating=ko.observable(a.rating),j.listView=ko.pureComputed(function(){return j.name()+"    "+j.rating()}),b.setPinPosterLocations(j.location());var k=b.getPinPosterLocations(),l=[];l.push(j.location()),console.log(l);var m=b.getMarkers();console.log(m);var n=b.getInfoWindows(),o=document.getElementById("show"),p=document.getElementById("hide"),q=document.getElementById("places-list"),r=document.getElementById("foursquare-header"),s=document.getElementById("autocomplete");o.style.display="none",this.setCurrentPlace=function(a){if(m.length<7){var b=0,c=0,d=0,f=0,g=(m.length,n.length);for(console.log(m),console.log(n),b;g>b;c++,b++){var h=m[b],i=n[c];if(a.name()==i.content&&a.name()===h.title)if(null!=h.getAnimation())for(f;g>f;d++,f++){var j=m[d],k=n[f];j.setAnimation(null),k.close(e,h)}else for(f;g>f;d++,f++){var j=m[d],k=n[f];j.setAnimation(null),k.close(e,h),h.setAnimation(google.maps.Animation.BOUNCE),i.open(e,h)}}}else{var b=0,c=0,d=0,f=0;m.splice(7);var g=(m.length,n.length);for(console.log(m),console.log(n),b;g>b;c++,b++){var h=m[b],i=n[c];if(a.name()==i.content&&a.name()===h.title)if(null!=h.getAnimation())for(f;g>f;d++,f++){var j=m[d],k=n[f];j.setAnimation(null),k.close(e,h)}else for(f;g>f;d++,f++){var j=m[d],k=n[f];j.setAnimation(null),k.close(e,h),h.setAnimation(google.maps.Animation.BOUNCE),i.open(e,h)}}}},$(s).devbridgeAutocomplete({lookup:k,minChars:1,onSearchComplete:function(a,b){q.style.display="none",q.style.webkitAnimationName="fadeOut",q.style.webkitAnimationDuration="1s",o.style.display="inline",o.style.webkitAnimationName="fadeIn",o.style.webkitAnimationDuration="1s";var c=[];for(suggestion in b){var d=b[suggestion].value;c.push(d)}i(),f(c)},onSelect:function(a){var b=[],c=a.value;b.push(c),console.log(b),i(),f(b),r.innerHTML="Foursquare recommended places(hide and/or populate with markers & click to choose!)"},showNoSuggestionNotice:!0,noSuggestionNotice:"Sorry, no matching results"}),o.addEventListener("click",function(){h()},!1),p.addEventListener("click",function(){i()},!1),window.mapBounds=new google.maps.LatLngBounds,f(l),window.addEventListener("resize",function(a){e.fitBounds(mapBounds)})},d={disableDefaultUI:!1},e=new google.maps.Map(document.getElementById("mapDiv"),d),f=function(){function d(a){return $.getJSON(i,function(b){var c=[];c=b.response.groups[0].items,a(c)}).error(function(a){f.text("Sorry, Foursquare articles could not be loaded")}),!1}var e=this;this.currentCity=ko.observableArray([]),this.currentCity=a.cities[0],console.log(e.currentCity);var f=$("#places-list");this.places=ko.observableArray([]);var g="WMGXUPU15HUVPMTMGK3WZPHVGBXKPXWMUQ5WW3DMRSOZUIH5",h="RFUOHDP441JSHFBS1AS0KLAGRVVRGNL2VACN0RHIJJNC5AT2",i="https://api.foursquare.com/v2/venues/explore?near="+e.currentCity+"&&client_id="+g+"&client_secret="+h+"&v=20130815&query=sushi";d(function(a){var d=a,f=0,g=0,h=0,i=d.length,j=[],k=[];for(f;i>f;f++){var l=d[f],m=l.venue.name;"Miu Japonés"!=m&&"Miu"!=m&&"Shibui Bilbo"!=m&&"Wok Chitau Nauo"!=m&&"Restaurante Xikelai Wok"!=m&&"SUMO Ledesma"!=m&&"SUMO"!=m&&j.push(l)}for(g;g<j.length;g++){var n=j[g],o=n.venue.name,p=n.venue.location.address,q=n.venue.location.city,r=n.venue.location.country,s=n.venue.rating,t={name:o,address:p,city:q,country:r,location:o+", "+p+", "+q+", "+r,rating:s};k.push(t)}for(h;h<k.length;h++){var u,v=k[h],w=v.name;"Kuma"===w?(u=w.replace("Kuma","KUMA"),v.name=u):"Mao Restaurante"===w?(u=w.replace("Mao Restaurante","Mao"),v.name=u):"SUMO Poza"===w?(u=w.replace("SUMO Poza","SUMO Pozas"),v.name=u):"Sakura"===w?(u=w.replace("Sakura","Restaurante Sakura"),v.name=u):"Wasabi Bilbao Restaurante Japones"===w&&(u=w.replace("Wasabi Bilbao Restaurante Japones","Restaurante Wasabi Bilbao"),v.name=u)}k.forEach(function(a){e.places.push(new c(a))}),b.setFoursquareData(d),b.setFilteredPlaces(j),b.setFilteredNames(k)})};ko.applyBindings(new f)}(),function(){var a={currentCity:null,cities:["Bilbao"],foursquareData:[],filteredPlaces:[],filteredNames:[],pinPosterLocations:[],markers:[],infoWindows:[]},b={setFoursquareData:function(b){a.foursquareData=b},getFoursquareData:function(){return a.foursquareData},setFilteredPlaces:function(b){a.filteredPlaces=b},getFilteredPlaces:function(){return a.filteredPlaces},setFilteredNames:function(b){a.filteredNames=b},getFilteredNames:function(){return a.filteredNames},setMarkers:function(b){a.markers.push(b)},getMarkers:function(){return a.markers},setInfoWindows:function(b){a.infoWindows.push(b)},getInfoWindows:function(){return a.infoWindows},setPinPosterLocations:function(b){a.pinPosterLocations.push(b)},getPinPosterLocations:function(){return a.pinPosterLocations},clearMarkers:function(){a.markers=[]},clearInfoWindows:function(){a.infoWindows=[]}},c=function(a){function c(a){var c=a.geometry.location.lat(),d=a.geometry.location.lng(),f=a.name,g=(a.formatted_address,window.mapBounds),h=new google.maps.Marker({map:e,position:a.geometry.location,title:f});b.setMarkers(h);var i=new google.maps.InfoWindow({content:f});b.setInfoWindows(i),google.maps.event.addListener(h,"click",function(){i.open(e,h)}),g.extend(new google.maps.LatLng(c,d)),e.fitBounds(g),e.setCenter(g.getCenter())}function d(a,b){b==google.maps.places.PlacesServiceStatus.OK&&c(a[0])}function f(a){var b=new google.maps.places.PlacesService(e);for(place in a){var c={query:a[place]};b.textSearch(c,d)}}function g(a){var b=0,c=m.length;for(console.log(c),b;c>b;b++)m[b].setMap(a)}function h(){q.style.display="block",q.style.webkitAnimationName="fadeIn",q.style.webkitAnimationDuration="1s",o.style.display="none",o.style.webkitAnimationName="fadeOut",o.style.webkitAnimationDuration="1s",r.innerHTML="Foursquare recommended places(choose!):",s.value=" ",m.splice(7),n.splice(7),g(e)}function i(){g(null),"none"==o.style.display?(o.style.display="inline",o.style.webkitAnimationName="fadeIn",o.style.webkitAnimationDuration="0.8s"):(o.style.display="none",o.style.webkitAnimationName="fadeOut",o.style.webkitAnimationDuration="1s")}var j=this;j.name=ko.observable(a.name),j.address=ko.observable(a.address),j.city=ko.observable(a.city),j.country=ko.observable(a.country),j.location=ko.observable(a.location),j.rating=ko.observable(a.rating),j.listView=ko.pureComputed(function(){return j.name()+"    "+j.rating()}),b.setPinPosterLocations(j.location());var k=b.getPinPosterLocations(),l=[];l.push(j.location()),console.log(l);var m=b.getMarkers();console.log(m);var n=b.getInfoWindows(),o=document.getElementById("show"),p=document.getElementById("hide"),q=document.getElementById("places-list"),r=document.getElementById("foursquare-header"),s=document.getElementById("autocomplete");o.style.display="none",this.setCurrentPlace=function(a){if(m.length<7){var b=0,c=0,d=0,f=0,g=(m.length,n.length);for(console.log(m),console.log(n),b;g>b;c++,b++){var h=m[b],i=n[c];if(a.name()==i.content&&a.name()===h.title)if(null!=h.getAnimation())for(f;g>f;d++,f++){var j=m[d],k=n[f];j.setAnimation(null),k.close(e,h)}else for(f;g>f;d++,f++){var j=m[d],k=n[f];j.setAnimation(null),k.close(e,h),h.setAnimation(google.maps.Animation.BOUNCE),i.open(e,h)}}}else{var b=0,c=0,d=0,f=0;m.splice(7);var g=(m.length,n.length);for(console.log(m),console.log(n),b;g>b;c++,b++){var h=m[b],i=n[c];if(a.name()==i.content&&a.name()===h.title)if(null!=h.getAnimation())for(f;g>f;d++,f++){var j=m[d],k=n[f];j.setAnimation(null),k.close(e,h)}else for(f;g>f;d++,f++){var j=m[d],k=n[f];j.setAnimation(null),k.close(e,h),h.setAnimation(google.maps.Animation.BOUNCE),i.open(e,h)}}}},$(s).devbridgeAutocomplete({lookup:k,minChars:1,onSearchComplete:function(a,b){q.style.display="none",q.style.webkitAnimationName="fadeOut",q.style.webkitAnimationDuration="1s";var c=[];for(suggestion in b){var d=b[suggestion].value;c.push(d)}i(),f(c)},onSelect:function(a){var b=[],c=a.value;b.push(c),console.log(b),i(),f(b),r.innerHTML="Foursquare recommended places(hide and/or populate with markers & click to choose!)"},showNoSuggestionNotice:!0,noSuggestionNotice:"Sorry, no matching results"}),o.addEventListener("click",function(){h()},!1),p.addEventListener("click",function(){i()},!1),window.mapBounds=new google.maps.LatLngBounds,f(l),window.addEventListener("resize",function(a){e.fitBounds(mapBounds)})},d={disableDefaultUI:!1},e=new google.maps.Map(document.getElementById("mapDiv"),d),f=function(){function d(a){return $.getJSON(i,function(b){var c=[];c=b.response.groups[0].items,a(c)}).error(function(a){f.text("Sorry, Foursquare articles could not be loaded")}),!1}var e=this;this.currentCity=ko.observableArray([]),this.currentCity=a.cities[0],console.log(e.currentCity);var f=$("#places-list");this.places=ko.observableArray([]);var g="WMGXUPU15HUVPMTMGK3WZPHVGBXKPXWMUQ5WW3DMRSOZUIH5",h="RFUOHDP441JSHFBS1AS0KLAGRVVRGNL2VACN0RHIJJNC5AT2",i="https://api.foursquare.com/v2/venues/explore?near="+e.currentCity+"&&client_id="+g+"&client_secret="+h+"&v=20130815&query=sushi";d(function(a){var d=a,f=0,g=0,h=0,i=d.length,j=[],k=[];for(f;i>f;f++){var l=d[f],m=l.venue.name;"Miu Japonés"!=m&&"Miu"!=m&&"Shibui Bilbo"!=m&&"Wok Chitau Nauo"!=m&&"Restaurante Xikelai Wok"!=m&&"SUMO Ledesma"!=m&&"SUMO"!=m&&j.push(l)}for(g;g<j.length;g++){var n=j[g],o=n.venue.name,p=n.venue.location.address,q=n.venue.location.city,r=n.venue.location.country,s=n.venue.rating,t={name:o,address:p,city:q,country:r,location:o+", "+p+", "+q+", "+r,rating:s};k.push(t)}for(h;h<k.length;h++){var u,v=k[h],w=v.name;"Kuma"===w?(u=w.replace("Kuma","KUMA"),v.name=u):"Mao Restaurante"===w?(u=w.replace("Mao Restaurante","Mao"),v.name=u):"SUMO Poza"===w?(u=w.replace("SUMO Poza","SUMO Pozas"),v.name=u):"Sakura"===w?(u=w.replace("Sakura","Restaurante Sakura"),v.name=u):"Wasabi Bilbao Restaurante Japones"===w&&(u=w.replace("Wasabi Bilbao Restaurante Japones","Restaurante Wasabi Bilbao"),v.name=u)}k.forEach(function(a){e.places.push(new c(a))}),b.setFoursquareData(d),b.setFilteredPlaces(j),b.setFilteredNames(k)})};ko.applyBindings(new f)}(),function(){var a={currentCity:null,cities:["Bilbao"],foursquareData:[],filteredPlaces:[],filteredNames:[],pinPosterLocations:[],markers:[],infoWindows:[]},b={setFoursquareData:function(b){a.foursquareData=b},getFoursquareData:function(){return a.foursquareData},setFilteredPlaces:function(b){a.filteredPlaces=b},getFilteredPlaces:function(){return a.filteredPlaces},setFilteredNames:function(b){a.filteredNames=b},getFilteredNames:function(){return a.filteredNames},setMarkers:function(b){a.markers.push(b)},getMarkers:function(){return a.markers},setInfoWindows:function(b){a.infoWindows.push(b)},getInfoWindows:function(){return a.infoWindows},setPinPosterLocations:function(b){a.pinPosterLocations.push(b)},getPinPosterLocations:function(){return a.pinPosterLocations},clearMarkers:function(){a.markers=[]},clearInfoWindows:function(){a.infoWindows=[]}},c=function(a){function c(a){var c=a.geometry.location.lat(),d=a.geometry.location.lng(),f=a.name,g=(a.formatted_address,window.mapBounds),h=new google.maps.Marker({map:e,position:a.geometry.location,title:f});b.setMarkers(h);var i=new google.maps.InfoWindow({content:f});b.setInfoWindows(i),google.maps.event.addListener(h,"click",function(){i.open(e,h)}),g.extend(new google.maps.LatLng(c,d)),e.fitBounds(g),e.setCenter(g.getCenter())}function d(a,b){var d=$("#google-map-error-panel");return b!=google.maps.places.PlacesServiceStatus.OK?void d.html("<h2>Sorry, Google Maps could not be loaded</h2>"):void(b==google.maps.places.PlacesServiceStatus.OK&&c(a[0]))}function f(a){if("undefined"==typeof google.maps.places)return $("#google-map-error-panel").html("<h2>Sorry, Google Maps could not be loaded</h2>"),void console.log("undefined!");var b=new google.maps.places.PlacesService(e);for(place in a){var c={query:a[place]};b.textSearch(c,d)}}function g(a){var b=0,c=m.length;for(console.log(c),b;c>b;b++)m[b].setMap(a)}function h(){q.style.display="block",q.style.webkitAnimationName="fadeIn",q.style.webkitAnimationDuration="1s",o.style.display="none",o.style.webkitAnimationName="fadeOut",o.style.webkitAnimationDuration="1s",r.innerHTML="Foursquare recommended places(choose!):",s.value=" ",m.splice(7),n.splice(7),g(e)}function i(){g(null),"none"==o.style.display?(o.style.display="inline",o.style.webkitAnimationName="fadeIn",o.style.webkitAnimationDuration="0.8s"):(o.style.display="none",o.style.webkitAnimationName="fadeOut",o.style.webkitAnimationDuration="1s")}var j=this;j.name=ko.observable(a.name),j.address=ko.observable(a.address),j.city=ko.observable(a.city),j.country=ko.observable(a.country),j.location=ko.observable(a.location),j.rating=ko.observable(a.rating),j.listView=ko.pureComputed(function(){return j.name()+"    "+j.rating()}),b.setPinPosterLocations(j.location());var k=b.getPinPosterLocations(),l=[];l.push(j.location()),console.log(l);var m=b.getMarkers();console.log(m);var n=b.getInfoWindows(),o=document.getElementById("show"),p=document.getElementById("hide"),q=document.getElementById("places-list"),r=document.getElementById("foursquare-header"),s=document.getElementById("autocomplete");o.style.display="none",this.setCurrentPlace=function(a){if(m.length<7){var b=0,c=0,d=0,f=0,g=(m.length,n.length);for(console.log(m),console.log(n),b;g>b;c++,b++){var h=m[b],i=n[c];if(a.name()==i.content&&a.name()===h.title)if(null!=h.getAnimation())for(f;g>f;d++,f++){var j=m[d],k=n[f];j.setAnimation(null),k.close(e,h)}else for(f;g>f;d++,f++){var j=m[d],k=n[f];j.setAnimation(null),k.close(e,h),h.setAnimation(google.maps.Animation.BOUNCE),i.open(e,h)}}}else{var b=0,c=0,d=0,f=0;m.splice(7);var g=(m.length,n.length);for(console.log(m),console.log(n),b;g>b;c++,b++){var h=m[b],i=n[c];if(a.name()==i.content&&a.name()===h.title)if(null!=h.getAnimation())for(f;g>f;d++,f++){var j=m[d],k=n[f];j.setAnimation(null),k.close(e,h)}else for(f;g>f;d++,f++){var j=m[d],k=n[f];j.setAnimation(null),k.close(e,h),h.setAnimation(google.maps.Animation.BOUNCE),i.open(e,h)}}}},$(s).devbridgeAutocomplete({lookup:k,minChars:1,onSearchComplete:function(a,b){q.style.display="none",q.style.webkitAnimationName="fadeOut",q.style.webkitAnimationDuration="1s";var c=[];for(suggestion in b){var d=b[suggestion].value;c.push(d)}i(),f(c)},onSelect:function(a){var b=[],c=a.value;b.push(c),console.log(b),i(),f(b),r.innerHTML="Foursquare recommended places(hide and/or populate with markers & click to choose!)"},showNoSuggestionNotice:!0,noSuggestionNotice:"Sorry, no matching results"}),o.addEventListener("click",function(){h()},!1),p.addEventListener("click",function(){i()},!1),window.mapBounds=new google.maps.LatLngBounds,f(l),window.addEventListener("resize",function(a){e.fitBounds(mapBounds)})},d={disableDefaultUI:!1};if("undefined"==typeof google)return $("#google-map-error-panel").html("<h2>Sorry, Google Maps could not be loaded</h2>"),void console.log("undefined!");var e=new google.maps.Map(document.getElementById("mapDiv"),d),f=function(){function d(a){return $.getJSON(i,function(b){var c=[];c=b.response.groups[0].items,a(c)}).error(function(a){f.html("<h2>Sorry, Foursquare articles could not be loaded</h2>")}),!1}var e=this;this.currentCity=ko.observableArray([]),this.currentCity=a.cities[0],console.log(e.currentCity);var f=($("#places-list"),$("#foursquare-error-panel"));this.places=ko.observableArray([]);var g="WMGXUPU15HUVPMTMGK3WZPHVGBXKPXWMUQ5WW3DMRSOZUIH5",h="RFUOHDP441JSHFBS1AS0KLAGRVVRGNL2VACN0RHIJJNC5AT2",i="https://api.foursquare.com/v2/venues/explore?near="+e.currentCity+"&&client_id="+g+"&client_secret="+h+"&v=20130815&query=sushi";d(function(a){var d=a,f=0,g=0,h=0,i=d.length,j=[],k=[];for(f;i>f;f++){var l=d[f],m=l.venue.name;"Miu Japonés"!=m&&"Miu"!=m&&"Shibui Bilbo"!=m&&"Wok Chitau Nauo"!=m&&"Restaurante Xikelai Wok"!=m&&"SUMO Ledesma"!=m&&"SUMO"!=m&&j.push(l)}for(g;g<j.length;g++){var n=j[g],o=n.venue.name,p=n.venue.location.address,q=n.venue.location.city,r=n.venue.location.country,s=n.venue.rating,t={name:o,address:p,city:q,country:r,location:o+", "+p+", "+q+", "+r,rating:s};k.push(t)}for(h;h<k.length;h++){var u,v=k[h],w=v.name;"Kuma"===w?(u=w.replace("Kuma","KUMA"),v.name=u):"Mao Restaurante"===w?(u=w.replace("Mao Restaurante","Mao"),v.name=u):"SUMO Poza"===w?(u=w.replace("SUMO Poza","SUMO Pozas"),v.name=u):"Sakura"===w?(u=w.replace("Sakura","Restaurante Sakura"),v.name=u):"Wasabi Bilbao Restaurante Japones"===w&&(u=w.replace("Wasabi Bilbao Restaurante Japones","Restaurante Wasabi Bilbao"),v.name=u)}k.forEach(function(a){e.places.push(new c(a))}),b.setFoursquareData(d),b.setFilteredPlaces(j),b.setFilteredNames(k)})};ko.applyBindings(new f)}();