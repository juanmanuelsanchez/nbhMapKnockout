<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/scripts/app.js - nbhMapKnockout</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="nbhMapKnockout" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.0.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/map.html">map</a></li>
                                <li><a href="../classes/Place.html">Place</a></li>
                                <li><a href="../classes/PlacesViewModel.html">PlacesViewModel</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: src/scripts/app.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * Created by juanmanuelsanchez on 10/5/15.
 */
/**
 * Created by juanmanuelsanchez on 10/5/15.
 */
/**
 * Created by juanmanuelsanchez on 9/5/15.
 */
/**
 * Created by juanmanuelsanchez on 7/5/15.
 */
/**
 * Created by juanmanuelsanchez on 6/5/15.
 */
/*jshint devel:true, unused:false*/
/*globals Model, octopus*/

(function () {



  var Model = {

    /**
     * Holds current city to search Foursquare recommendations
     *
     * @property currentCity
     * @type String
     * @default null
     */
    currentCity: null,

    /**
     * Holds the value to set the current city
     *
     * @property cities
     * @type Array
     * @default [&quot;Bilbao&quot;]
     */
    cities: [&quot;Bilbao&quot;],

    /**
     * Holds all recommendations from Foursquare
     *
     * @property filteredData
     * @type Array
     */
    foursquareData: [],

    /**
     * Holds filtered recommendations from Foursquare to properly work with Google Maps API
     *
     * @property filteredPlaces
     * @type Array
     */
    filteredPlaces: [],

    /**
     * Holds Foursquare filtered place&#x27;s modified names to fit Google Map&#x27;s marker&#x27;s names
     *
     * @property filteredNames
     * @type Array
     */
    filteredNames: [],

    /**
     * Holds Foursquare filtered place&#x27;s to pass to Google Maps
     *
     * @property pinPosterLocations
     * @type Array
     */
    pinPosterLocations: [],

    /**
     * Holds markers from Google Maps
     *
     * @property markers
     * @type Array
     */
    markers: [],

    /**
     * Holds infowindows from Google Maps
     *
     * @property infoWindows
     * @type Array
     */
    infoWindows: []


  };


  var octopus = {
    /**
     * Stores the recommended places taken from Foursquare API
     *
     * @property setFoursquareData
     * @type Function
     * @param places {Object} The places recommended by Foursquare
     */
    setFoursquareData: function (places) {

      Model[&quot;foursquareData&quot;] = places;


    },

    /**
     * Retrieves the recommended places taken from Foursquare API
     *
     * @property getFoursquareData
     * @type Function
     */

    getFoursquareData: function () {

      return Model.foursquareData;
    },

    /**
     * Stores filtered recommended places taken from Foursquare API
     *
     * @property setFilteredPlaces
     * @type Function
     * @param place {Object} The filtered places recommended by Foursquare
     */

    setFilteredPlaces: function (place) {

      Model[&quot;filteredPlaces&quot;] = place;
    },

    /**
     * Retrieves filtered recommended places taken from Foursquare API
     *
     * @property getFilteredPlaces
     * @type Function
     */

    getFilteredPlaces: function () {

      return Model.filteredPlaces;
    },

    /**
     * Stores filtered recommended places taken from Foursquare API to match Google Maps markers
     * and infoWindows
     *
     * @property setFilteredNames
     * @type Function
     * @param name {Object} The filtered place recommended by Foursquare to match markers and infoWindows
     */

    setFilteredNames: function (name) {

      Model[&quot;filteredNames&quot;] = name;

    },

    /**
     * Retrieves filtered recommended places taken from Foursquare API to match Google Maps markers
     * and infoWindows
     *
     * @property getFilteredNames
     * @type Function
     */

    getFilteredNames: function () {

      return Model.filteredNames;
    },

    /**
     * Stores markers from Google Maps API
     *
     * @property setMarkers
     * @type Function
     * @param marker {Object} The markers from Google Maps API
     */

    setMarkers: function (marker) {

      Model.markers.push(marker);
    },

    /**
     * Retrieves markers from Google Maps API
     *
     * @property getMarkers
     * @type Function
     */

    getMarkers: function () {

      return Model.markers;
    },

    /**
     * Stores infoWindows from Google Maps API
     *
     * @property setInfoWindows
     * @type Function
     * @param infoWindow {Object} The infoWindows from Google Maps API
     */

    setInfoWindows: function (infoWindow) {

      Model.infoWindows.push(infoWindow);
    },

    /**
     * Retrieves infoWindows from Google Maps API
     *
     * @property getInfoWindows
     * @type Function
     */

    getInfoWindows: function () {

      return Model.infoWindows;
    },

    /**
     * Stores locations which are going to be rendered on Google Maps API
     *
     * @property setPinPosterLocations
     * @type Function
     * @param location {Object} The filtered place recommended by Foursquare that matchs markers and infoWindows
     * which is going to be rendered on Google Maps
     */

    setPinPosterLocations: function (location) {

      Model.pinPosterLocations.push(location);
    },

    /**
     * Retrieves locations which are going to be rendered on Google Maps API
     *
     * @property getPinPosterLocations
     * @type Function
     */

    getPinPosterLocations: function () {

      return Model.pinPosterLocations;
    },

    clearMarkers: function () {

      Model.markers=[];

    },
    clearInfoWindows: function () {

      Model.infoWindows=[];
    }

  };

  //Place object related to the HTML View

  /**
   * A &quot;class&quot; defining recommended restaurants
   *
   * @class Place
   * @constructor
   * @param data {Object} The filtered place recommended by Foursquare that matches markers and infoWindows
   * which is going to be rendered on Google Maps
   */
  var Place = function (data) {


    var self= this;
    self.name= ko.observable(data.name);
    self.address= ko.observable(data.address);
    self.city= ko.observable(data.city);
    self.country= ko.observable(data.country);
    self.location= ko.observable(data.location);
    self.rating= ko.observable(data.rating);

    self.listView= ko.pureComputed(function () {//It&#x27;s better than ko.computed for calculate and return a value
      return self.name() + &quot;    &quot; + self.rating();
    });


    console.log(self.address());


    octopus.setPinPosterLocations(self.location());
    var locationsList= octopus.getPinPosterLocations();
    var locations= [];
    locations.push(self.location());
    console.log(locations);

    var markersList=octopus.getMarkers();
    console.log(markersList);

    var infoWindowsList=octopus.getInfoWindows();
    console.log(infoWindowsList);


    var showButton= document.getElementById(&quot;show&quot;);
    var hideButton= document.getElementById(&quot;hide&quot;);
    var placesList= document.getElementById(&quot;places-list&quot;);
    var foursquareHeader= document.getElementById(&quot;foursquare-header&quot;);
    var inputBox= document.getElementById(&quot;autocomplete&quot;);


    showButton.style.display=&quot;none&quot;;


    //console.log(locationsList);

    /**
     * Sets the scope to a clickedListItem through the data-bind on &#x27;li&#x27; items of the DOM, animates
     * the related Google Maps marker
     *
     * @method setCurrentPlace
     * @param clickedListItem {Object} The clicked list item from the DOM
     */

    this.setCurrentPlace = function (clickedListItem) {

      if (markersList.length&lt;7) {
        var j = 0;
        var i = 0;
        var h = 0;
        var w = 0;

        //infoWindowsList=[];
        //markersList = octopus.getMarkers();
        //infoWindowsList = octopus.getInfoWindows();
        var markersLength= markersList.length;
        var infoWindowsLength= infoWindowsList.length;
        //console.log(clickedListItem.name());
        //console.log(clickedListItem.address());
        console.log(markersList);
        console.log(infoWindowsList);

        for (i, j; i &lt; markersLength, j &lt; infoWindowsLength; i++, j++) {

          var marker= markersList[j];
          var info= infoWindowsList[i];
          //marker.setAnimation(null);
          //info.close(map,marker);
          if (clickedListItem.address() == info.content &amp;&amp; clickedListItem.address() === marker.title) {

            if (marker.getAnimation() != null) {

              for (h, w; h &lt; markersLength, w &lt; infoWindowsLength; h++, w++) {
                var pin= markersList[h];
                var infowindow= infoWindowsList[w];

                pin.setAnimation(null);
                infowindow.close(map, marker);
              }

            } else {

              for (h, w; h &lt; markersLength, w &lt; infoWindowsLength; h++, w++) {
                var pin2= markersList[h];
                var infowindow2= infoWindowsList[w];

                pin2.setAnimation(null);
                infowindow2.close(map, marker);
                marker.setAnimation(google.maps.Animation.BOUNCE);
                info.open(map, marker);
              }


            }
          }
        }
      }else{

        var j = 0;
        var i = 0;
        var h = 0;
        var w = 0;
        markersList.splice(7);
        infoWindowsList.splice(7);
        var markersLength2= markersList.length;
        var infoWindowsLength2= infoWindowsList.length;
        //console.log(clickedListItem.name());
        //console.log(clickedListItem.address());
        //console.log(markersList);
        //console.log(infoWindowsList);

        for (i, j; i &lt; markersLength2, j &lt; infoWindowsLength2; i++, j++) {

          var marker2= markersList[j];
          var info2= infoWindowsList[i];
          //marker.setAnimation(null);
          //info.close(map,marker);
          if (clickedListItem.address() == info2.content &amp;&amp; clickedListItem.address() === marker2.title) {

            if (marker2.getAnimation() != null) {

              for (h, w; h &lt; markersLength2, w &lt; infoWindowsLength2; h++, w++) {
                var pin3= markersList[h];
                var infowindow3= infoWindowsList[w];

                pin3.setAnimation(null);
                infowindow3.close(map, marker2);
              }

            } else {

              for (h, w; h &lt; markersLength2, w &lt; infoWindowsLength2; h++, w++) {
                var pin4 = markersList[h];
                var infowindow4 = infoWindowsList[w];

                pin4.setAnimation(null);
                infowindow4.close(map, marker2);
                marker2.setAnimation(google.maps.Animation.BOUNCE);
                info2.open(map, marker2);
              }


            }
          }
        }


      }


    };

    /**
     * Creates an autocomplete functionality on the search bar to filter the rendered places.
     * Credits: Ajax Autocomplete for jQuery, version 1.2.18, (c) 2014 Tomas Kirda.
     *
     * @method devbridgeAutocomplete
     */

    $(inputBox).devbridgeAutocomplete({

      /**
       * Holds locations which are rendered on Google Maps API to make string matching suggestions
       *
       * @property lookup
       * @type Array
       */

      lookup: locationsList,

      /**
       * Denotes the number of characters to define the string matching
       *
       * @property minChars
       * @type Number
       */

      minChars: 1,

      /**
       * Suggest the rendered locations on the search bar
       *
       * @property onSearchComplete
       * @type Function
       * @param locationsList {Array} the locations rendered on Google Map
       * @param suggestions {Array} the locations suggested by the autocomplete functionality
       * of the search bar
       */

      onSearchComplete: function(locationsList, suggestions) {

        placesList.style.display=&quot;none&quot;;
        placesList.style.webkitAnimationName=&#x27;fadeOut&#x27;;
        placesList.style.webkitAnimationDuration=&#x27;1s&#x27;;
        showButton.style.display=&quot;none&quot;;
        showButton.style.webkitAnimationName=&#x27;fadeOut&#x27;;
        showButton.style.webkitAnimationDuration=&#x27;1s&#x27;;


        var listSuggestions=[];
        for(suggestion in suggestions) {

          var location= suggestions[suggestion].value;
          listSuggestions.push(location);

        }
        clearMarkers();
        pinPoster(listSuggestions);


      },

      /**
       * Filters the selected location on the search bar and renders it on the map
       *
       * @property onSelect
       * @type Function
       * @param suggestion {Array} the location selected on the search bar
       *
       */

      onSelect: function (suggestion) {

        var newList=[];
        var newLocation=suggestion.value;
        newList.push(newLocation);
        console.log(newList);
        clearMarkers();
        //markersList=[];
        pinPoster(newList);

        if(hideButton.style.display==&#x27;none&#x27; &amp;&amp; showButton.style.display==&#x27;none&#x27;) {

          hideButton.style.display=&quot;inline&quot;;
          hideButton.style.webkitAnimationName=&#x27;fadeIn&#x27;;
          hideButton.style.webkitAnimationDuration=&#x27;0.8s&#x27;;
        }


      },

      /**
       * Sets string mismatches communication on the search bar
       *
       * @property showNoSuggestionNotice
       * @type Boolean
       */

      showNoSuggestionNotice: true,

      /**
       * Communicates string mismatches communication on the search bar
       *
       * @property showNoSuggestionNotice
       * @type Boolean
       */
      noSuggestionNotice: &#x27;Sorry, no matching results&#x27;

    });

    /**
     * A &quot;class&quot; defining a map with recommended restaurants
     *
     * @class map
     * @constructor
     */


    /**
     * Creates markers and infoWindows for each of the locations, sets map&#x27;s center and bounds and animates
     * the marker when clicked
     *
     * @method createMapMarker
     * @param placeData {Object} The filtered place recommended by Foursquare that matches markers and infoWindows
     * which is going to be rendered on Google Maps
     */



    function createMapMarker(placeData) {

      console.log(placeData);
      var lat= placeData.geometry.location.lat();
      var lon= placeData.geometry.location.lng();
      var name= placeData.name;
      var address=placeData.formatted_address;
      var placeInfoWindow= setInfoWindow(placeData);

      var bounds= window.mapBounds;

      function setInfoWindow(placeData) {
        var contentString = &#x27;&lt;div id=&quot;content&quot;&gt;&#x27; + &#x27;&lt;h3 id=&quot;firstHeading&quot; class=&quot;firstHeading&quot;&gt;&#x27;+ placeData.formatted_address + &#x27;&lt;/h3&gt;&#x27; + &#x27;&lt;/div&gt;&#x27;;
        return contentString;
      }

      //console.log(address);

      var marker= new google.maps.Marker({
        map: map,
        position: placeData.geometry.location,
        title:address
      });

      octopus.setMarkers(marker);


      var infoWindow= new google.maps.InfoWindow({
        content:address

      });




      octopus.setInfoWindows(infoWindow);


      google.maps.event.addListener(marker, &#x27;click&#x27;, function () {

        //infoWindow.setContent(placeInfoWindow);
        infoWindow.open(map, marker);


      });



      bounds.extend(new google.maps.LatLng(lat, lon));

      map.fitBounds(bounds);

      map.setCenter(bounds.getCenter());

    }

    /**
     * Retrieves the result of the query for each of the locations
     *
     * @function callback
     * @param results {Object} query results from Google Maps Places
     * @property OK denotes the success of the request
     */

    function callback(results, status) {

      var $googleMapsErrorPanel= $(&#x27;#google-map-error-panel&#x27;);

      if(status != google.maps.places.PlacesServiceStatus.OK) {
        $googleMapsErrorPanel.html(&#x27;&lt;h2&gt;Sorry, Google Maps could not be loaded&lt;/h2&gt;&#x27;);
        return;
      }

      if (status == google.maps.places.PlacesServiceStatus.OK) {

        createMapMarker(results[0]);

      }

    }

    /**
     * Creates an instance of Google Maps Places
     *
     * @function pinPoster
     * @param locations {Object} The filtered place recommended by Foursquare that matches markers and infoWindows
     * which is going to be rendered on Google Maps
     */

    function pinPoster(locations) {

      if(typeof google.maps.places ==&#x27;undefined&#x27;) {

        $(&#x27;#google-map-error-panel&#x27;).html(&#x27;&lt;h2&gt;Sorry, Google Maps could not be loaded&lt;/h2&gt;&#x27;);
        console.log(&#x27;undefined!&#x27;);
        return;
      }

      var service = new google.maps.places.PlacesService(map);


      for (place in locations) {

        var request = {

          query: locations[place]

        };

        service.textSearch(request, callback);

      }

    }

    /**
     * Listens to a showButton&#x27;s click event
     *
     * @method addEventListener
     */

    showButton.addEventListener(&#x27;click&#x27;, function () {

      showMarkers();
      showButton.style.display=&quot;none&quot;;
      showButton.style.webkitAnimationName=&#x27;fadeOut&#x27;;
      showButton.style.webkitAnimationDuration=&#x27;1s&#x27;;
      hideButton.style.display=&quot;inline&quot;;
      hideButton.style.webkitAnimationName=&#x27;fadeIn&#x27;;
      hideButton.style.webkitAnimationDuration=&#x27;0.8s&#x27;;


    }, false);

    /**
     * Listens to a hideButton&#x27;s click event
     *
     * @method addEventListener
     */

    hideButton.addEventListener(&#x27;click&#x27;, function () {

      clearMarkers();
      showButton.style.display=&quot;inline&quot;;
      showButton.style.webkitAnimationName=&#x27;fadeIn&#x27;;
      showButton.style.webkitAnimationDuration=&#x27;0.8s&#x27;;
      hideButton.style.display=&quot;none&quot;;
      hideButton.style.webkitAnimationName=&#x27;fadeOut&#x27;;
      hideButton.style.webkitAnimationDuration=&#x27;1s&#x27;;


    }, false);

    /**
     * Updates the map
     *
     * @method setAllMap
     * @param map
     */

    function setAllMap(map) {

      var j = 0;


      var length = markersList.length;
      console.log(length);

      for (j; j &lt; length; j++) {

        markersList[j].setMap(map);
      }

    }

    /**
     * Shows the markers on the map
     *
     * @method showMarkers
     */

    function showMarkers() {

      placesList.style.display=&quot;block&quot;;
      placesList.style.webkitAnimationName=&#x27;fadeIn&#x27;;
      placesList.style.webkitAnimationDuration=&#x27;1s&#x27;;
      //foursquareHeader.innerHTML=&quot;Foursquare recommended places(choose!):&quot;;
      inputBox.value=&quot; &quot;;
      markersList.splice(7);
      infoWindowsList.splice(7);
      setAllMap(map);

    }

    /**
     * Hides the markers on the map
     *
     * @method clearMarkers
     */

    function clearMarkers() {

      setAllMap(null);



    }


    window.mapBounds = new google.maps.LatLngBounds();


    pinPoster(locations);




    window.addEventListener(&#x27;resize&#x27;, function (e) {
      map.fitBounds(mapBounds);

    })

  };

  /**
   * A &quot;class&quot; defining a map with recommended restaurants
   *
   * @class map
   * @constructor
   */

  var mapOptions = {

    disableDefaultUI: false
  };

  if(typeof google ==&#x27;undefined&#x27;) {

    $(&#x27;#google-map-error-panel&#x27;).html(&#x27;&lt;h2&gt;Sorry, Google Maps could not be loaded&lt;/h2&gt;&#x27;);
    console.log(&#x27;undefined!&#x27;);
    return;
  }

  var map = new google.maps.Map(document.getElementById(&quot;mapDiv&quot;), mapOptions);



  /**
   * A &quot;class&quot; that retrieves and process the data to create the listView and the map
   *
   * @class PlacesViewModel
   * @constructor
   */

  var PlacesViewModel = function () {

    var self = this;

    /**
     * Holds the value of current city taken from the Model
     *
     * @property this.currentCity
     * @type observableArray
     */

    this.currentCity = ko.observableArray([]);
    this.currentCity = Model.cities[0];
    console.log(self.currentCity);

    var $foursquareElem = $(&#x27;#places-list&#x27;);
    var $foursquareErrorPanel= $(&#x27;#foursquare-error-panel&#x27;);
    //$foursquareElem.text(&quot;&quot;);

    /**
     * Holds the objects retrieved from Foursquare API
     *
     * @property this.places
     * @type observableArray
     */

    this.places = ko.observableArray([]);

    //API key for Foursquare
    var clientID = &#x27;WMGXUPU15HUVPMTMGK3WZPHVGBXKPXWMUQ5WW3DMRSOZUIH5&#x27;;
    var clientSecret = &#x27;RFUOHDP441JSHFBS1AS0KLAGRVVRGNL2VACN0RHIJJNC5AT2&#x27;;
    var foursquareUrl = &#x27;https://api.foursquare.com/v2/venues/explore?near=&#x27; + self.currentCity + &#x27;&amp;&amp;client_id=&#x27; +
        clientID + &#x27;&amp;client_secret=&#x27; + clientSecret + &#x27;&amp;v=20130815&amp;query=sushi&#x27;;


    /**
     * Gets the data from Foursquare API and process data to create the map
     *
     * @function getDataFoursquare
     */

    function getDataFoursquare(callback) {

      $.getJSON(foursquareUrl, function (data) {

        var places = [];
        places = data.response.groups[0].items;
        callback(places);

      }).error(function (e) {

        //$foursquareElem.text(&quot;Sorry, Foursquare articles could not be loaded&quot;);
        $foursquareErrorPanel.html(&#x27;&lt;h2&gt;Sorry, Foursquare articles could not be loaded&lt;/h2&gt;&#x27;);

      });

      return false;

    }



    //Callback function
    getDataFoursquare(function (placesData) {

      var placesList = placesData;//All the Foursquare data
      console.log(placesList);
      var j = 0;
      var i = 0;
      var h = 0;
      var z=0;
      var length = placesList.length;
      var filteredList = [];//Foursquare filtered data
      var filteredNames = [];//Foursquare filtered place&#x27;s modified names to fit Google Map&#x27;s marker&#x27;s names
      var filteredPlaces= [];

      for (j; j &lt; length; j++) {

        var place = placesList[j];
        var name = place.venue.name;
        if (name != &quot;Miu Japonés&quot; &amp;&amp; name != &quot;Miu&quot; &amp;&amp; name != &quot;Shibui Bilbo&quot; &amp;&amp; name != &quot;Wok Chitau Nauo&quot; &amp;&amp; name != &quot;Restaurante Xikelai Wok&quot; &amp;&amp; name !=&quot;SUMO Ledesma&quot; &amp;&amp; name !=&quot;SUMO&quot;) {

          filteredList.push(place);

        }

      }


      //Transforms the Foursquare API object into writable object

      for (i; i &lt; filteredList.length; i++) {

        var placeItem = filteredList[i];
        var locationName = placeItem.venue.name;
        var locationAddress = placeItem.venue.location.address;
        var locationCity = placeItem.venue.location.city;
        var locationCountry = placeItem.venue.location.country;
        var locationRating= placeItem.venue.rating;

        var location = {

          name: locationName,
          address: locationAddress,
          city: locationCity,
          country: locationCountry,
          location: locationName + &#x27;, &#x27; + locationAddress + &#x27;, &#x27; + locationCity + &#x27;, &#x27; + locationCountry,
          rating: locationRating
        };

        filteredNames.push(location);

      }

      //Modifies the name property of Foursquare places to fit Google Map&#x27;s marker&#x27;s title property

      for (h; h &lt; filteredNames.length; h++) {

        var locationItem = filteredNames[h];
        var locationItemName = locationItem.name;
        var newName;

        if (locationItemName === &quot;Kuma&quot;) {
          //console.log(&quot; Kuma Eureka!&quot;);
          newName = locationItemName.replace(&quot;Kuma&quot;, &quot;KUMA&quot;);
          locationItem.name = newName;
        } else if (locationItemName === &quot;Mao Restaurante&quot;) {
          //console.log(&quot;Mao Eureka!&quot;);
          newName = locationItemName.replace(&quot;Mao Restaurante&quot;, &quot;Mao&quot;);
          locationItem.name = newName;
        } else if (locationItemName === &quot;SUMO Poza&quot;) {
          //console.log(&quot;SUMO Poza Eureka!&quot;);
          newName = locationItemName.replace(&quot;SUMO Poza&quot;, &quot;SUMO Pozas&quot;);
          locationItem.name = newName;
        } else if (locationItemName === &quot;Sakura&quot;) {
          //console.log(&quot;Sakura Eureka!&quot;);
          newName = locationItemName.replace(&quot;Sakura&quot;, &quot;Restaurante Sakura&quot;);
          locationItem.name = newName;
        } else if (locationItemName === &quot;Wasabi Bilbao Restaurante Japones&quot;) {
          //console.log(&quot;Wasabi Bilbao Restaurante Japones Eureka!&quot;);
          newName = locationItemName.replace(&quot;Wasabi Bilbao Restaurante Japones&quot;, &quot;Restaurante Wasabi Bilbao&quot;);
          locationItem.name = newName;
        }
      }


      for (z; z &lt; filteredNames.length; z++) {

        var locationItem = filteredNames[z];
        var locationItemAddress = locationItem.address;
        var newAddress;

        if (locationItemAddress === &quot;Lersundi Kalea, 3&quot;) {
          console.log(&quot; Wasabi Eureka!&quot;);
          newAddress = locationItemAddress.replace(&quot;Lersundi Kalea, 3&quot;, &quot;Lersundi Kalea, 3, 48009 Bilbao, Bizkaia, Spain&quot;);
          locationItem.address = newAddress;
        } else if (locationItemAddress === &quot;Arbolantxa 2&quot;) {
          console.log(&quot; Sakura Eureka!&quot;);
          newAddress = locationItemAddress.replace(&quot;Arbolantxa 2&quot;, &quot;Arbolantxa Kalea, 2, 48001 Bilbao, Bizkaia, Spain&quot;);
          locationItem.address = newAddress;
        } else if (locationItemAddress === &quot;Ercilla 8&quot;) {
          console.log(&quot; Kuma Eureka!&quot;);
          newAddress = locationItemAddress.replace(&quot;Ercilla 8&quot;, &quot;Ercilla Kalea, 8, 48009 Bilbao, Bizkaia, Spain&quot;);
          locationItem.address = newAddress;
        } else if (locationItemAddress === &quot;C/ Licenciado Poza, 39&quot;) {
          console.log(&quot; SUMO Pozas Eureka!&quot;);
          newAddress = locationItemAddress.replace(&quot;C/ Licenciado Poza, 39&quot;, &quot;Poza Lizentziatuaren Kalea, 39, 48011 Bilbao, Bizkaia, Spain&quot;);
          locationItem.address = newAddress;
        } else if (locationItemAddress === &quot;Ledesma, 30&quot;) {
          console.log(&quot; Asia Chic Eureka!&quot;);
          newAddress = locationItemAddress.replace(&quot;Ledesma, 30&quot;, &quot;Ledesma Musikariaren Kalea, 30, 48001 Bilbao, Bizkaia, Spain&quot;);
          locationItem.address = newAddress;
        } else if (locationItemAddress === &quot;Ibáñez de Bilbao, 11&quot;) {
          console.log(&quot; Mao Eureka!&quot;);
          newAddress = locationItemAddress.replace(&quot;Ibáñez de Bilbao, 11&quot;, &quot;Ibáñez de Bilbao Kalea, 11, 48009 Bilbao, Bizkaia, Spain&quot;);
          locationItem.address = newAddress;
        } else if (locationItemAddress === &quot;Licenciado Poza 48&quot;) {
          console.log(&quot; Sushi Artist Eureka!&quot;);
          newAddress = locationItemAddress.replace(&quot;Licenciado Poza 48&quot;, &quot;Licenciado Poza 48, 48013 Bilbao, Biscay, Spain&quot;);
          locationItem.address = newAddress;

        }
      }

      //Creates places to be rendered on the map

      filteredNames.forEach(function (placeItem) {

        self.places.push(new Place(placeItem));

      });

      //Stores the data on Model Object

      octopus.setFoursquareData(placesList);
      octopus.setFilteredPlaces(filteredList);
      octopus.setFilteredNames(filteredNames);
      // console.log(placesList);
      //console.log(filteredList);
      //console.log(filteredNames);


    });


  };


  ko.applyBindings(new PlacesViewModel());

}());

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
